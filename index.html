<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tron Grid Game</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    canvas {
      display: block;
      background: repeating-linear-gradient(
          to right,
          #0ff 0px,
          #0ff 2px,
          transparent 2px,
          transparent 40px
        ),
        repeating-linear-gradient(
          to bottom,
          #0ff 0px,
          #0ff 2px,
          transparent 2px,
          transparent 40px
        );
    }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="700" height="500"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const gridSize = 5; // movement grid
let trail = [];
let maxTrail = 200; // longer trail
let direction = "RIGHT";
let nextDirection = "RIGHT";

let player = { x: 100, y: 100, size: 5 };
let storm = { x: 50, y: 50, w: 600, h: 400 };

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw storm
  ctx.fillStyle = "rgba(255,0,0,0.3)";
  ctx.fillRect(storm.x, storm.y, storm.w, storm.h);

  // Draw trail
  ctx.fillStyle = "cyan";
  for (let i = 0; i < trail.length; i++) {
    ctx.fillRect(trail[i].x, trail[i].y, player.size, player.size);
  }

  // Draw player
  ctx.fillStyle = "lime";
  ctx.fillRect(player.x, player.y, player.size, player.size);
}

function update() {
  direction = nextDirection;

  if (direction === "LEFT") player.x -= gridSize;
  if (direction === "UP") player.y -= gridSize;
  if (direction === "RIGHT") player.x += gridSize;
  if (direction === "DOWN") player.y += gridSize;

  // Trail logic
  trail.push({ x: player.x, y: player.y });
  if (trail.length > maxTrail) {
    trail.shift();
  }

  // Collision with walls
  if (
    player.x < 0 ||
    player.y < 0 ||
    player.x >= canvas.width ||
    player.y >= canvas.height
  ) {
    gameOver();
  }

  // Collision with own trail
  for (let i = 0; i < trail.length - 1; i++) {
    if (player.x === trail[i].x && player.y === trail[i].y) {
      gameOver();
    }
  }

  // Collision with storm
  if (
    player.x < storm.x ||
    player.y < storm.y ||
    player.x + player.size > storm.x + storm.w ||
    player.y + player.size > storm.y + storm.h
  ) {
    gameOver();
  }
}

function gameOver() {
  alert("Game Over!");
  player = { x: 100, y: 100, size: 5 };
  trail = [];
  direction = "RIGHT";
  nextDirection = "RIGHT";
}

document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowLeft" && direction !== "RIGHT") nextDirection = "LEFT";
  if (e.key === "ArrowUp" && direction !== "DOWN") nextDirection = "UP";
  if (e.key === "ArrowRight" && direction !== "LEFT") nextDirection = "RIGHT";
  if (e.key === "ArrowDown" && direction !== "UP") nextDirection = "DOWN";
});

function gameLoop() {
  update();
  draw();
}
setInterval(gameLoop, 60);
</script>
</body>
</html>
